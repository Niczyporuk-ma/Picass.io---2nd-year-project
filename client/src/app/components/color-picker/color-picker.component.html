<!-- inspired by : https://malcoded.com/posts/angular-color-picker/ -->
<div class="color-tool">
    <div class="color-wrapper">
        <app-color-palette [hue]="hue" (color)="color = $event"></app-color-palette>
        <app-color-slider (color)="hue = $event" style="margin-left: 16px"></app-color-slider>
    </div>
    <div class="input-wrapper">
        <span class="text">{{ this.rgbaToHex(color) }}</span>
        <div
            class="color-div"
            (click)="selectPrimaryColor($event)"
            [ngStyle]="{ 'background-color': colorService.primaryColorPreview || 'white' }"
        ></div>
        <div
            class="color-div"
            (click)="selectSecondaryColor($event)"
            [ngStyle]="{ 'background-color': colorService.secondaryColorPreview || 'white' }"
        ></div>

        <button (click)="this.colorService.swapPrimaryAndSecondary()" class="swap-button">Swap</button>
    </div>

    <div class="ten-last">
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[0])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[0])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[0] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[1])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[1])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[1] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[2])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[2])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[2] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[3])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[3])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[3] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[4])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[4])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[4] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[5])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[5])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[5] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[6])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[6])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[6] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[7])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[7])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[7] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[8])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[8])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[8] || 'white' }"
        ></div>
        <div
            class="color-div"
            (mousedown)="onLeftClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[9])"
            (contextmenu)="onRightClickPreviousColor($event, colorService.tenLastUsedColors.toArray()[9])"
            [ngStyle]="{ 'background-color': colorService.tenLastUsedColors.toArray()[9] || 'white' }"
        ></div>
    </div>
    <div class="side-input-wrapper">
        <label
            >R: <input type="text" (keyup)="this.isRed = true; adjustColor($event)" (focus)="disableShortcut()" (blur)="enableShortcut()" /><br />
        </label>
        <label
            >G:
            <input type="text" (keyup)="this.isGreen = true; adjustColor($event)" (focus)="disableShortcut()" (blur)="enableShortcut()" />
            <br />
        </label>

        <label
            >B:
            <input type="text" (keyup)="this.isBlue = true; adjustColor($event)" (focus)="disableShortcut()" (blur)="enableShortcut()" />
        </label>

    </div>

    <div>
        <mat-card>
            Opacité prim:
            <mat-slider
                min="0"
                max="1"
                step="0.01"
                (change)="changePrimaryOpacity($event.value)"
                (input)="this.colorService.primaryOpacityPreview = $event.value"
                [value]="this.colorService.primaryOpacityPreview"
            ></mat-slider>
            {{ this.colorService.primaryOpacityPreview }}
        </mat-card>
    </div>

    <div>
        <mat-card>
            Opacité sec:
            <mat-slider
                min="0"
                max="1"
                step="0.01"
                (change)="changeSecondaryOpacity($event.value)"
                (input)="this.colorService.secondaryOpacityPreview = $event.value"
                [value]="this.colorService.secondaryOpacityPreview"
            ></mat-slider>
            {{ this.colorService.secondaryOpacityPreview }}
        </mat-card>
    </div>
    <div>
        <button
            class="confirm"
            (mousedown)="this.colorService.isConfirmed = true; this.toolManager.showPalette = false; this.colorService.setValuesOnConfirm()"
        >
            confirmer
        </button>
        <button class="cancel" (mousedown)="this.toolManager.showPalette = false; this.colorService.resetValuesOnCancel()">annuler</button>
    </div>
</div>
